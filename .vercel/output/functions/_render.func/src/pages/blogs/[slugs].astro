---
import Layout from "@/layouts/Layout.astro";
import { urlFor } from "../../../sanity/utilis/image";
import { getBlog } from "../../../sanity/utilis/sanity";
import { formatDate } from "../../../sanity/utilis/index";

const { slugs } = Astro.params;
const blog = await getBlog(slugs ?? null);
---

{!blog ? (
  <Layout title="Article introuvable">
    <p class="text-center text-gray-500 text-lg mt-8">
      Le blogo demand√© est introuvable
    </p>
  </Layout>
) : (
  <Layout title={blog.title}>
    <article class="max-w-3xl mx-auto px-4 py-12">
      <h1 class="text-4xl font-bold text-gray-900 mb-4">{blog.title}</h1>
      
      {blog.subtitle && (
        <h2 class="text-2xl font-medium text-gray-700 mb-6">{blog.subtitle}</h2>
      )}
      
      {blog.image && (
        <img 
          src={urlFor(blog.image).width(800).height(400).url()} 
          alt={blog.image.alt || blog.title}
          class="w-full h-auto rounded-lg shadow-md mb-8"
        />
      )}
      
      <time 
        datetime={blog.publishedAt}
        class="block text-sm text-gray-500 mb-6"
      >
        {formatDate(blog.publishedAt)}
      </time>
      
      <p class="text-lg leading-relaxed text-gray-800 whitespace-pre-line">
        {blog.description}
      </p>
    </article>
  </Layout>
)}
